<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>NFT</title>
    <style>
        #output { overflow: auto; }
        #output > p { overflow-wrap: break-word; }
        #output span { color: blue; }
        #output span.error { color: red; }
    </style>
</head>
<body>
    <p>Current name is {{name}}</p>
    <input type="text" id="newName" name="newName" value="{{name}}">
    <button>apply</button>
    <br/><div id=output></div>

    <script>
        let button = document.querySelector("button");
        let input = document.querySelector("#newName");
        let output = document.querySelector("#output");
        let wsUri = "ws://127.0.0.1:8080/";
        let websocket = new WebSocket(wsUri);

        button.addEventListener("click", onClickButton);

        websocket.onopen = function (e) {
            writeToScreen("CONNECTED");
            doSend("WebSocket rocks");
        };

        websocket.onclose = function (e) {
            writeToScreen("DISCONNECTED");
        };

        websocket.onmessage = function (e) {
            writeToScreen("<span>RESPONSE: " + e.data + "</span>");
        };

        websocket.onerror = function (e) {
            writeToScreen("<span class=error>ERROR:</span> " + e.data);
        };

        function doSend(message) {
            writeToScreen("SENT: " + message);
            websocket.send(message);
        }

        function writeToScreen(message) {
            output.insertAdjacentHTML("afterbegin", "<p>" + message + "</p>");
        }

        function onClickButton() {
            let text = input.value;
            text && doSend(text);
            input.value = "";
            input.focus();
        }
    </script>
</body>
</html>